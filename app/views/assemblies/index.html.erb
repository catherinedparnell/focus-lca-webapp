<!-- JQuery -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>

<!-- JQuery UI -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.js"></script>

<!-- icons -->
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

<!--Angular script -->
<%= javascript_include_tag "assembly/application" %>

<table ng-controller="assemblyController" ng-app="assembly">

  <!--Angular scripting functions (<script> ... </script>>) should be placed inside ng-contoller and ng-app tag-->

  <!-- Templates for model creation view -->
    <!--New Assebbly -->
    <script type="text/ng-template" id="build-assembly.html">
        <h3>{{assembly.name}}</h3>
        <ul dnd-list="assembly" class="collapsible" data-collapsible="expandable">
            <li ng-repeat="item in assembly.items"
                dnd-draggable="item"
                dnd-effect-allowed="move"
                dnd-moved="list.splice($index, 1)"
                dnd-selected="models.selected = item"
                ng-class="{selected: models.selected === item}"
                ng-include="item.type + '.html'">
            </li>
        </ul>
    </script>

    <!--Subassembly-->
    <script type="text/ng-template" id="subassembly.html">
        <h3>{{item.name}}</h3>
        <ul dnd-list="item.items" class="collapsible" data-collapsible="expandable">
            <li ng-repeat="item in item.items"
                dnd-draggable="item"
                dnd-effect-allowed="move"
                dnd-moved="list.splice($index, 1)"
                dnd-selected="models.selected = item"
                ng-class="{selected: models.selected === item}"
                ng-include="item.type + '.html'">
            </li>
        </ul>
    </script>

    <!--Material-->
    <script type="text/ng-template" id="material.html">
        <h3>{{item.name}}</h3>
        <ul dnd-list="item.processes"
            dnd-allowed-types="['process']" class="collapsible" data-collapsible="expandable">
            <li ng-repeat="process in item.processes"
                dnd-draggable="process"
                dnd-effect-allowed="move"
                dnd-moved="list.splice($index, 1)"
                dnd-selected="models.selected = item"
                ng-class="{selected: models.selected === item}"
                ng-include="'process.html'">
            </li>
        </ul>
    </script>

    <!--Process-->
    <script type="text/ng-template" id="process.html">
        <div class="process">{{item.name}}</div>
    </script>
  
  <!-- Templates for Library sidebar -->
    <!--Section-level-->
    <script type="text/ng-template" id="library-section.html">
        <h2>{{section.name}}!</h2>
        <ul dnd-list="section.items" ng-init="list=section.items">

          <li ng-repeat="item in list"
              dnd-disable-if="item.type == 'category'"
              dnd-type="item.type"
              dnd-draggable="item"
              dnd-effect-allowed="move"
              dnd-moved="list.splice($index, 1)"
              ng-class="{selected: list.selected === item}"
              ng-include="'library-' + item.type + '.html'">
          </li>

        </ul>
    </script>

    <!--Category-level-->
    <script type="text/ng-template" id="library-category.html">
        <h3>{{item.name}}</h3>
        <ul dnd-list="item.items" ng-init="list=item.items", ng-init="Item=item">
            <li ng-repeat="item in list"
                dnd-draggable="item"
                dnd-effect-allowed="move"
                dnd-moved="list.splice($index, 1)"
                dnd-selected="Item.selected = item"
                ng-class="{selected: Item.selected === item}"
                ng-include="'library-' + item.type + '.html'">
            </li>
        </ul>
    </script>

    <!--Element-level => process-->
    <script type="text/ng-template" id="library-process.html">
        <div class="library-process">{{item.name}}</div>
    </script>

    <!--Element-level => material-->
    <script type="text/ng-template" id="library-material.html">
      <div class="library-material">{{item.name}}</div>
    </script>

  <!--End of Angular app function definition-->

  <!--Beginning of the page -->
  <tr>
    <td class="library">
      <h1>Library</h1>
      <ul>
          <li ng-repeat="section in library"
              ng-include="'library-section.html'">
          </li>
      </ul>
    </td>

    <td class="assembly">
      <div ng-include="'build-assembly.html'"></div>
    </td>
  </tr>
  <!--End of page-->

</table>
